VehAgeBandSumm=ddply(VehAgeBand, "Vehicle.Age.Band", numcolwise(sum))
VehAgeBandSumm2=data.frame(VehAgeBandSumm,
AvgLosses=round(VehAgeBandSumm$logloss/VehAgeBandSumm$Count,digits=3),
Obs=round(VehAgeBandSumm$Count/sum(VehAgeBandSumm$Count)*100,digits=2)
)
VehAgeBand=data.frame(Vehicle.Age.Band,logloss,Count)
rm(list=ls())
InsuranceData=read.csv(file="Insurance Data Updated.csv")
set.seed(1000)
subset <- sample(nrow(InsuranceData),nrow(InsuranceData)*0.80)
Insurance_train = InsuranceData[subset,]
attach(Insurance_train)
Insurance_test = InsuranceData[-subset,]
logloss<- log(Losses)
InsuranceData=data.frame(Insurance_train,logloss)
attach(InsuranceData)
VehAgeBand=data.frame(Vehicle.Age.Band,logloss,Count)
View(VehAgeBand)
VehAgeBandSumm=ddply(VehAgeBand, "Vehicle.Age.Band", numcolwise(sum))
library("plyr", lib.loc="~/R/win-library/2.15")
VehAgeBandSumm=ddply(VehAgeBand, "Vehicle.Age.Band", numcolwise(sum))
VehAgeBandSumm2=data.frame(VehAgeBandSumm,
AvgLosses=round(VehAgeBandSumm$logloss/VehAgeBandSumm$Count,digits=3),
Obs=round(VehAgeBandSumm$Count/sum(VehAgeBandSumm$Count)*100,digits=2)
)
View(VehAgeBandSumm2)
par(mar = c(5,5,2,5))
barplot(VehAgeBandSumm2$Obs,col="lightgray",las=1,border=0,axes=F,ylim=range(0:40))
axis(side=4)
mtext("%Obs",side=4,line=2)
par(new = T)
plot(VehAgeBandSumm2$Age,VehAgeBandSumm2$AvgLosses,ylim=range(0:7),pch=18, ylab = NA,xlab=NA)
plot(VehAgeBandSumm2$Vehicle.Age.Band,VehAgeBandSumm2$AvgLosses,ylim=range(0:7),pch=18, ylab = NA,xlab=NA)
mtext("Vehicle Age",side=1,line=1.7)
mtext("Mean Loss($)",side=2,line=2.5)
lines(VehAgeBandSumm2$Vehicle.Age.Band,VehAgeBandSumm2$AvgLosses, type='l', col="red", lwd=3)
lines(VehAgeBandSumm2$Vehicle.Age.Band,VehAgeBandSumm2$AvgCappedLosses, type='l', col="darkgreen", lwd=2)
par(xpd=T)
legend("bottom", inset=-.22,
c("% # of Policies","Avg Losses","Avg Cap. Losses"),
fill=c("lightgray","red","darkgreen"), horiz=TRUE)
par(mar = c(5,5,2,5))
barplot(VehAgeBandSumm2$Obs,col="lightgray",las=1,border=0,axes=F,ylim=range(0:50))
axis(side=4)
mtext("%Obs",side=4,line=2)
par(new = T)
plot(VehAgeBandSumm2$Vehicle.Age.Band,VehAgeBandSumm2$AvgLosses,ylim=range(0:7),pch=18, ylab = NA,xlab=NA)
mtext("Vehicle Age",side=1,line=1.7)
mtext("Mean Loss($)",side=2,line=2.5)
lines(VehAgeBandSumm2$Vehicle.Age.Band,VehAgeBandSumm2$AvgLosses, type='l', col="red", lwd=3)
par(xpd=T)
legend("bottom", inset=-.22,
c("% # of Policies","Avg Losses","Avg Cap. Losses"),
fill=c("lightgray","red","darkgreen"), horiz=TRUE)
VehAgeBand=data.frame(Vehicle.Age.Band,logloss,Count)
VehAgeBandSumm=ddply(VehAgeBand, "Vehicle.Age.Band", numcolwise(sum))
VehAgeBandSumm2=data.frame(VehAgeBandSumm,
AvgLosses=round(VehAgeBandSumm$logloss/VehAgeBandSumm$Count,digits=3),
Obs=round(VehAgeBandSumm$Count/sum(VehAgeBandSumm$Count)*100,digits=2)
)
par(mar = c(5,5,2,5))
barplot(VehAgeBandSumm2$Obs,col="lightgray",las=1,border=0,axes=F,ylim=range(0:50))
axis(side=4)
mtext("%Obs",side=4,line=2)
par(new = T)
plot(VehAgeBandSumm2$Vehicle.Age.Band,VehAgeBandSumm2$AvgLosses,ylim=range(0:7),pch=18, ylab = NA,xlab=NA)
mtext("Vehicle Age",side=1,line=1.7)
mtext("Mean Loss($)",side=2,line=2.5)
lines(VehAgeBandSumm2$Vehicle.Age.Band,VehAgeBandSumm2$AvgLosses, type='l', col="red", lwd=3)
par(xpd=T)
legend("bottom", inset=-.22,
c("% # of Policies","Avg Losses"),
fill=c("lightgray","red"), horiz=TRUE)
plot(logloss ~Gender,col="#FF2030")
GenderList=data.frame(Gender,logloss,Count)
GenderListSumm=ddply(GenderList, "Gender", numcolwise(sum))
GenderListSumm2=data.frame(GenderListSumm,
AvgLosses=round(GenderListSumm$logloss/GenderListSumm$Count,digits=3),
Obs=round(GenderListSumm$Count/sum(GenderListSumm$Count)*100,digits=2)
)
View(GenderListSumm2)
par(mar = c(5,5,2,5))
barplot(GenderListSumm2$Obs,col="lightgray",las=1,border=0,axes=F,ylim=range(0:60))
axis(side=4)
mtext("%Obs",side=4,line=2)
par(new = T)
plot(GenderListSumm2$Gender,GenderListSumm2$AvgLosses,ylim=range(0:7),pch=18, ylab = NA,xlab=NA)
mtext("Vehicle Age",side=1,line=1.7)
mtext("Mean Loss($)",side=2,line=2.5)
lines(GenderListSumm2$Gender,GenderListSumm2$AvgLosses, type='l', col="red", lwd=3)
par(xpd=T)
legend("bottom", inset=-.22,
c("% # of Policies","Avg Losses"),
fill=c("lightgray","red"), horiz=TRUE)
GenderList=data.frame(Gender,logloss,Count)
GenderListSumm=ddply(GenderList, "Gender", numcolwise(sum))
GenderListSumm2=data.frame(GenderListSumm,
AvgLosses=round(GenderListSumm$logloss/GenderListSumm$Count,digits=3),
Obs=round(GenderListSumm$Count/sum(GenderListSumm$Count)*100,digits=2)
)
par(mar = c(5,5,2,5))
barplot(GenderListSumm2$Obs,col="lightgray",las=1,border=0,axes=F,ylim=range(0:60))
axis(side=4)
mtext("%Obs",side=4,line=2)
par(new = T)
plot(GenderListSumm2$Gender,GenderListSumm2$AvgLosses,ylim=range(0:7),pch=18, ylab = NA,xlab=NA)
mtext("Gender",side=1,line=1.7)
mtext("Log Loss($)",side=2,line=2.5)
lines(GenderListSumm2$Gender,GenderListSumm2$AvgLosses, type='l', col="red", lwd=3)
par(xpd=T)
legend("bottom", inset=-.22,
c("% # of Policies","Avg Losses"),
fill=c("lightgray","red"), horiz=TRUE)
MaritalList=data.frame(Married,logloss,Count)
MaritalListSumm=ddply(MaritalList, "Married", numcolwise(sum))
MaritalListSumm2=data.frame(MaritalListSumm,
AvgLosses=round(MaritalListSumm$logloss/MaritalListSumm$Count,digits=3),
Obs=round(MaritalListSumm$Count/sum(MaritalListSumm$Count)*100,digits=2)
)
View(MaritalListSumm2)
par(mar = c(5,5,2,5))
barplot(MaritalListSumm2$Obs,col="lightgray",las=1,border=0,axes=F,ylim=range(0:60))
axis(side=4)
mtext("%Obs",side=4,line=2)
par(new = T)
plot(MaritalListSumm2$Married,MaritalListSumm2$AvgLosses,ylim=range(0:7),pch=18, ylab = NA,xlab=NA)
mtext("Marital",side=1,line=1.7)
mtext("Log Loss($)",side=2,line=2.5)
lines(MaritalListSumm2$Married,MaritalListSumm2$AvgLosses, type='l', col="red", lwd=3)
par(xpd=T)
legend("bottom", inset=-.22,
c("% # of Policies","Avg Losses"),
fill=c("lightgray","red"), horiz=TRUE)
View(Insurance_test)
FuelTypeList=data.frame(Fuel.Type,logloss,Count)
FuelTypeListSumm=ddply(FuelTypeList, "Fuel.Type", numcolwise(sum))
FuelTypeListSumm2=data.frame(FuelTypeListSumm,
AvgLosses=round(FuelTypeListSumm$logloss/FuelTypeListSumm$Count,digits=3),
Obs=round(FuelTypeListSumm$Count/sum(FuelTypeListSumm$Count)*100,digits=2)
)
View(FuelTypeListSumm2)
par(mar = c(5,5,2,5))
barplot(FuelTypeListSumm2$Obs,col="lightgray",las=1,border=0,axes=F,ylim=range(0:60))
axis(side=4)
mtext("%Obs",side=4,line=2)
par(new = T)
plot(FuelTypeListSumm2$Fuel.Type,FuelTypeListSumm2$AvgLosses,ylim=range(0:7),pch=18, ylab = NA,xlab=NA)
mtext("FuelType Status",side=1,line=1.7)
mtext("Log Loss($)",side=2,line=2.5)
lines(FuelTypeListSumm2$Fuel.Type,FuelTypeListSumm2$AvgLosses, type='l', col="red", lwd=3)
par(mar = c(5,5,2,5))
barplot(GenderListSumm2$Obs,col="lightgray",las=1,border=0,axes=F,ylim=range(0:60))
axis(side=4)
View(GenderListSumm2)
mtext("%Obs",side=4,line=2)
par(new = T)
plot(GenderListSumm2$Gender,GenderListSumm2$AvgLosses,ylim=range(0:7),pch=18, ylab = NA,xlab=NA)
mtext("Gender",side=1,line=1.7)
mtext("Log Loss($)",side=2,line=2.5)
lines(GenderListSumm2$Gender,GenderListSumm2$AvgLosses, type='l', col="red", lwd=3)
par(xpd=T)
legend("bottom", inset=-.22,
c("% # of Policies","Avg Losses"),
fill=c("lightgray","red"), horiz=TRUE)
View(VehAgeBandSumm2)
View(MaritalListSumm2)
View(FuelTypeListSumm2)
par(mar = c(5,5,2,5))
barplot(FuelTypeListSumm2$Obs,col="lightgray",las=1,border=0,axes=F,ylim=range(0:80))
axis(side=4)
mtext("%Obs",side=4,line=2)
par(new = T)
plot(FuelTypeListSumm2$Fuel.Type,FuelTypeListSumm2$AvgLosses,ylim=range(0:7),pch=18, ylab = NA,xlab=NA)
mtext("FuelType Status",side=1,line=1.7)
mtext("Log Loss($)",side=2,line=2.5)
lines(FuelTypeListSumm2$Fuel.Type,FuelTypeListSumm2$AvgLosses, type='l', col="red", lwd=3)
par(xpd=T)
legend("bottom", inset=-.22,
c("% # of Policies","Avg Losses"),
fill=c("lightgray","red"), horiz=TRUE)
plot(Age, Years.of.Driving.Experience,col="#FF2030")
library("plyr", lib.loc="~/R/win-library/2.15")
rm(list=ls())
InsuranceData=read.csv(file="Insurance Data Updated.csv")
set.seed(1000)
subset <- sample(nrow(InsuranceData),nrow(InsuranceData)*0.80)
Insurance_train = InsuranceData[subset,]
Insurance_test = InsuranceData[-subset,]
logloss<- log(Losses)
InsuranceData=data.frame(Insurance_train,logloss)
attach(InsuranceData)
AgeProf=data.frame(Age,logloss,Count)
AgeProfSumm=ddply(AgeProf, "Age", numcolwise(sum))
AgeProfSumm2=data.frame(AgeProfSumm,
AvgLosses=round(AgeProfSumm$logloss/AgeProfSumm$Count,digits=3),
Obs=round(AgeProfSumm$Count/sum(AgeProfSumm$Count)*100,digits=2)
)
par(mar = c(5,5,2,5))
barplot(AgeProfSumm2$Obs,col="lightgray",las=1,border=0,axes=F)
axis(side=4)
mtext("%Obs",side=4,line=2)
par(new = T)
plot(AgeProfSumm2$Age,AgeProfSumm2$AvgLosses,ylim=range(4:7),pch=18, ylab = NA,xlab=NA)
mtext("Age",side=1,line=1.2)
mtext("Log Loss($)",side=2,line=2.5)
lines(AgeProfSumm2$Age,AgeProfSumm2$AvgLosses, type='l', col="red", lwd=3)
par(xpd=T)
legend("bottom", inset=-.22,
c("% # of Policies","Avg Losses"),
fill=c("lightgray","red"), horiz=TRUE)
AgeProf=data.frame(Age,logloss,Count)
logloss<- log(Losses)
InsuranceData=data.frame(Insurance_train,logloss)
set.seed(1000)
subset <- sample(nrow(InsuranceData),nrow(InsuranceData)*0.80)
Insurance_train = InsuranceData[subset,]
Insurance_test = InsuranceData[-subset,]
InsuranceData=read.csv(file="Insurance Data Updated.csv")
set.seed(1000)
subset <- sample(nrow(InsuranceData),nrow(InsuranceData)*0.80)
Insurance_train = InsuranceData[subset,]
Insurance_test = InsuranceData[-subset,]
Insurance_test = InsuranceData[-subset,]
logloss<- log(Losses)
InsuranceData=data.frame(Insurance_train,logloss)
logloss<- log(Insurance_train$Losses)
InsuranceData=data.frame(Insurance_train,logloss)
attach(InsuranceData)
AgeProf=data.frame(Age,logloss,Count)
AgeProfSumm=ddply(AgeProf, "Age", numcolwise(sum))
AgeProfSumm2=data.frame(AgeProfSumm,
AvgLosses=round(AgeProfSumm$logloss/AgeProfSumm$Count,digits=3),
Obs=round(AgeProfSumm$Count/sum(AgeProfSumm$Count)*100,digits=2)
)
par(mar = c(5,5,2,5))
barplot(AgeProfSumm2$Obs,col="lightgray",las=1,border=0,axes=F)
axis(side=4)
mtext("%Obs",side=4,line=2)
par(new = T)
plot(AgeProfSumm2$Age,AgeProfSumm2$AvgLosses,ylim=range(4:7),pch=18, ylab = NA,xlab=NA)
mtext("Age",side=1,line=1.2)
mtext("Log Loss($)",side=2,line=2.5)
lines(AgeProfSumm2$Age,AgeProfSumm2$AvgLosses, type='l', col="red", lwd=3)
par(xpd=T)
legend("bottom", inset=-.22,
c("% # of Policies","Avg Losses"),
fill=c("lightgray","red"), horiz=TRUE)
View(AgeProfSumm2)
max(AgeProfSumm2$AvgLosses)
min(AgeProfSumm2$AvgLosses)
AgeBand=data.frame(Age.Band,logloss,Count)
AgeBandSumm=ddply(AgeBand, "Age.Band", numcolwise(sum))
AgeBandSumm2=data.frame(AgeBandSumm,
AvgLosses=round(AgeBandSumm$logloss/AgeBandSumm$Count,digits=3),
Obs=round(AgeBandSumm$Count/sum(AgeBandSumm$Count)*100,digits=2)
)
par(mar = c(5,5,2,5))
barplot(AgeBandSumm2$Obs,col="lightgray",las=1,border=0,axes=F,ylim=range(0:50))
axis(side=4)
mtext("%Obs",side=4,line=2)
par(new = T)
plot(AgeBandSumm2$Age,AgeBandSumm2$AvgLosses,ylim=range(4:7),pch=18, ylab = NA,xlab=NA)
mtext("Age",side=1,line=1.7)
mtext("Log Loss($)",side=2,line=2.5)
lines(AgeBandSumm2$Age,AgeBandSumm2$AvgLosses, type='l', col="red", lwd=3)
lines(AgeBandSumm2$Age,AgeBandSumm2$AvgCappedLosses, type='l', col="darkgreen", lwd=2)
par(xpd=T)
legend("bottom", inset=-.22,
c("% # of Policies","Avg Losses"),
fill=c("lightgray","red"), horiz=TRUE)
plot(logloss ~Age.Band,col=rgb(74,126,187,max=255))
plot(logloss ~Vehicle.Age.Band,col="#FF2030")
VehAgeBand=data.frame(Vehicle.Age.Band,logloss,Count)
VehAgeBandSumm=ddply(VehAgeBand, "Vehicle.Age.Band", numcolwise(sum))
VehAgeBandSumm2=data.frame(VehAgeBandSumm,
AvgLosses=round(VehAgeBandSumm$logloss/VehAgeBandSumm$Count,digits=3),
Obs=round(VehAgeBandSumm$Count/sum(VehAgeBandSumm$Count)*100,digits=2)
)
par(mar = c(5,5,2,5))
barplot(VehAgeBandSumm2$Obs,col="lightgray",las=1,border=0,axes=F,ylim=range(0:50))
axis(side=4)
mtext("%Obs",side=4,line=2)
par(new = T)
plot(VehAgeBandSumm2$Vehicle.Age.Band,VehAgeBandSumm2$AvgLosses,ylim=range(0:7),pch=18, ylab = NA,xlab=NA)
mtext("Vehicle Age",side=1,line=1.7)
mtext("Log Loss($)",side=2,line=2.5)
lines(VehAgeBandSumm2$Vehicle.Age.Band,VehAgeBandSumm2$AvgLosses, type='l', col="red", lwd=3)
par(xpd=T)
legend("bottom", inset=-.22,
c("% # of Policies","Avg Losses"),
fill=c("lightgray","red"), horiz=TRUE)
plot(logloss ~Age,col=rgb(74,126,187,max=255))
plot(logloss ~Age,col=rgb(74,126,187,max=255))
rm(list=ls())
InsuranceData=read.csv(file="Insurance Data Updated.csv")
set.seed(1000)
subset <- sample(nrow(InsuranceData),nrow(InsuranceData)*0.80)
Insurance_train = InsuranceData[subset,]
Insurance_test = InsuranceData[-subset,]
logloss<- log(Insurance_train$Losses)
InsuranceData=data.frame(Insurance_train,logloss)
attach(InsuranceData)
plot(logloss ~Age,col=rgb(74,126,187,max=255))
boxplot(logloss~Age)
boxplot(logloss~Age.Band)
plot(logloss ~Age.Band,col=rgb(74,126,187,max=255))
AgeProf=data.frame(Age,logloss,Count)
AgeProfSumm=ddply(AgeProf, "Age", numcolwise(sum))
AgeProfSumm2=data.frame(AgeProfSumm,
AvgLosses=round(AgeProfSumm$logloss/AgeProfSumm$Count,digits=3),
Obs=round(AgeProfSumm$Count/sum(AgeProfSumm$Count)*100,digits=2)
)
par(mar = c(5,5,2,5))
barplot(AgeProfSumm2$Obs,col="lightgray",las=1,border=0,axes=F)
axis(side=4)
mtext("%Obs",side=4,line=2)
par(new = T)
plot(AgeProfSumm2$Age,AgeProfSumm2$AvgLosses,ylim=range(4:7),pch=18, ylab = NA,xlab=NA)
mtext("Age",side=1,line=1.2)
mtext("Log Loss($)",side=2,line=2.5)
lines(AgeProfSumm2$Age,AgeProfSumm2$AvgLosses, type='l', col="red", lwd=3)
par(xpd=T)
legend("bottom", inset=-.22,
c("% # of Policies","Avg Losses"),
fill=c("lightgray","red"), horiz=TRUE)
min(AgeProfSumm2$AvgLosses)
plot(logloss ~Age.Band,col=rgb(74,126,187,max=255))
AgeProf=data.frame(Age,logloss,Count)
AgeProfSumm=ddply(AgeProf, "Age", numcolwise(sum))
AgeProfSumm2=data.frame(AgeProfSumm,
AvgLosses=round(AgeProfSumm$logloss/AgeProfSumm$Count,digits=3),
install.packages("lmtest")
install.packages("sandwich")
install.packages("plyr")
install.packages("ggplot2")
library("lmtest")
library("sandwich")
library("plyr")
library("ggplot2")
rm(list=ls())
InsuranceData=read.csv(file="Insurance Data Updated.csv")
summary(InsuranceData)
set.seed(1000)
subset <- sample(nrow(InsuranceData),nrow(InsuranceData)*0.80)
Insurance_train = InsuranceData[subset,]
Insurance_test = InsuranceData[-subset,]
attach(Insurance_train)
plot(Losses,col=rgb(74,126,187,max=255),pch=18,ylab="Losses",xlab="No. of Records")
grid(nx=NA,ny=NULL,col=rgb(165,165,165,max=255),lty=1)
library("lmtest")
library("sandwich")
library("plyr")
library("ggplot2")
rm(list=ls())
InsuranceData=read.csv(file="Insurance Data Updated.csv")
summary(InsuranceData)
set.seed(1000)
subset <- sample(nrow(InsuranceData),nrow(InsuranceData)*0.80)
Insurance_train = InsuranceData[subset,]
Insurance_test = InsuranceData[-subset,]
attach(Insurance_train)
plot(Losses,col=rgb(74,126,187,max=255),pch=18,ylab="Losses",xlab="No. of Records")
grid(nx=NA,ny=NULL,col=rgb(165,165,165,max=255),lty=1)
hist(Losses,breaks=100, xlab="Losses (00s)",ylab="Density of Policy", main="Distribution of Losses",col=rgb(218,238,243,max=255),border=0,prob=TRUE)
curve(dnorm(x,mean=mean(Losses),sd=sd(Losses)),col="red",lwd=2,add=TRUE)
lines(density(Losses,adjust=3),col=rgb(112,48,160,max=255),lwd=2)
summary(Losses)
quantile(Losses,c(0.05,0.1,0.25,0.5,0.75,0.9,0.95,0.975,0.99,0.995))
logloss<-log(Losses)
hist(logloss,breaks=100, xlab="LogLoss",ylab="Density of Policy", main="Distribution of LogLoss",col=rgb(218,238,243,max=255),border=0,prob=TRUE)
curve(dnorm(x,mean=mean(logloss),sd=sd(logloss)),col="red",lwd=2,add=TRUE)
lines(density(logloss,adjust=3),col=rgb(112,48,160,max=255),lwd=2)
par(mfrow=c (2, 2))
plot(logloss ~Age.Band,col="#00000033")
plot(logloss ~Gender,col="#00000033")
plot(logloss ~Married,col="#00000033")
plot(logloss ~Fuel.Type,col="#00000033")
par(mfrow=c (1, 1))
plot(logloss ~Vehicle.Age.Band,col="#00000033")
bar<-ggplot(Insurance_train, aes(Gender,logloss,fill=Age.Band))
bar+ stat_summary(fun.y=mean,geom="histogram", position="dodge", width=0.2)
bar<-ggplot(Insurance_train, aes(Married, logloss,fill=Age.Band))
bar+ stat_summary(fun.y=mean,geom="histogram", position="dodge", width=0.2)
cor(Years.of.Driving.Experience,Age)
cor(logloss, Age)
cor(logloss,Years.of.Driving.Experience)
cor(logloss,Number.of.Vehicles)
oneway.test(logloss ~Age.Band,var.equal=F)
t.test(logloss ~Gender)
t.test(logloss ~Married)
t.test(logloss ~Fuel.Type)
model_1 <- lm(logloss ~Number.of.Vehicles+Age.Band:Years.of.Driving.Experience+Gender +Married +Vehicle.Age +Fuel.Type)
summary(model_1)
step(model_1,direction="backward")
model_2 <- lm(logloss ~Age.Band:Years.of.Driving.Experience+Gender +Married +Vehicle.Age +Fuel.Type)
summary(model_2)
modelone_summary <- summary(model_1)
summary(model_1)
mean((modelone_summary$residuals)^2)
modeltwo_summary <- summary(model_2)
mean((modeltwo_summary$residuals)^2)
modelone_summary$adj.r.squared
modeltwo_summary$adj.r.squared
AIC(model_1)
AIC(model_2)
BIC(model_1)
BIC(model_2)
testdata <- predict(model_2, Insurance_test)
testdata
tlogloss<-log(Insurance_test$Losses)
mean((testdata - tlogloss)^2)        #MSE from 20% sample
mean((modeltwo_summary$residuals)^2)
par(mfrow=c (1, 2))
plot(model_2)
model_a<- lm(logloss ~Age, subset=Age.Band=="16-25")
summary(model_a)
oneway.test(logloss ~Age.Band,var.equal=F)
t.test(logloss ~Gender)
t.test(logloss ~Gender)
t.test(logloss ~Married)
t.test(logloss ~Fuel.Type)
View(InsuranceData)
View(InsuranceData)
library("lmtest")
library("sandwich")
library("plyr")
library("ggplot2")
rm(list=ls())
InsuranceData=read.csv(file="Insurance Data Updated.csv")
summary(InsuranceData)
plot(Losses,col=rgb(74,126,187,max=255),pch=18,ylab="Losses",xlab="No. of Records")
grid(nx=NA,ny=NULL,col=rgb(165,165,165,max=255),lty=1)
set.seed(1000)
subset <- sample(nrow(InsuranceData),nrow(InsuranceData)*0.80)
Insurance_train = InsuranceData[subset,]
Insurance_test = InsuranceData[-subset,]
attach(Insurance_train)
plot(Losses,col=rgb(74,126,187,max=255),pch=18,ylab="Losses",xlab="No. of Records")
grid(nx=NA,ny=NULL,col=rgb(165,165,165,max=255),lty=1)
hist(Losses,breaks=100, xlab="Losses (00s)",ylab="Density of Policy", main="Distribution of Losses",col=rgb(218,238,243,max=255),border=0,prob=TRUE)
curve(dnorm(x,mean=mean(Losses),sd=sd(Losses)),col="red",lwd=2,add=TRUE)
lines(density(Losses,adjust=3),col=rgb(112,48,160,max=255),lwd=2)
summary(Losses)
logloss<-log(Losses)
logloss<-log(Losses)
hist(logloss,breaks=100, xlab="LogLoss",ylab="Density of Policy", main="Distribution of LogLoss",col=rgb(218,238,243,max=255),border=0,prob=TRUE)
curve(dnorm(x,mean=mean(logloss),sd=sd(logloss)),col="red",lwd=2,add=TRUE)
lines(density(logloss,adjust=3),col=rgb(112,48,160,max=255),lwd=2)
par(mfrow=c (2, 2))
plot(logloss ~Age.Band,col="#00000033")
plot(logloss ~Gender,col="#00000033")
plot(logloss ~Married,col="#00000033")
plot(logloss ~Fuel.Type,col="#00000033")
par(mfrow=c (1, 1))
plot(logloss ~Vehicle.Age.Band,col="#00000033")
install.packages("lpSolve")
install.packages("linprog")
View(InsuranceData)
library("lmtest")
library("sandwich")
library("plyr")
library("ggplot2")
install.packages("lmtest")
rm(list=ls())
InsuranceData=read.csv(file="Insurance Data Updated.csv")
View(InsuranceData)
View(InsuranceData)
plot(Losses,col=rgb(74,126,187,max=255),pch=18,ylab="Losses",xlab="No. of Records")
InsuranceData=read.csv(file="Insurance Data Updated.csv")
```
```{r}
summary(InsuranceData)
```
# Sampling (Split Dataset Randomly)
### Next we sample 80% of the original data and use it as the training set. The remaining 20% is used as test set. The regression model will be built on the training set and future performance of your model will be evaluated with the test set.
```{r}
set.seed(1000)
subset <- sample(nrow(InsuranceData),nrow(InsuranceData)*0.80)
Insurance_train = InsuranceData[subset,]
Insurance_test = InsuranceData[-subset,]
attach(Insurance_train)
```
# Response Variable Exploration
# Plot of Losses
```{r}
plot(Losses,col=rgb(74,126,187,max=255),pch=18,ylab="Losses",xlab="No. of Records")
grid(nx=NA,ny=NULL,col=rgb(165,165,165,max=255),lty=1)
hist(Losses,breaks=100, xlab="Losses (00s)",ylab="Density of Policy", main="Distribution of Losses",col=rgb(218,238,243,max=255),border=0,prob=TRUE)
curve(dnorm(x,mean=mean(Losses),sd=sd(Losses)),col="red",lwd=2,add=TRUE)
lines(density(Losses,adjust=3),col=rgb(112,48,160,max=255),lwd=2)
summary(Losses)
quantile(Losses,c(0.05,0.1,0.25,0.5,0.75,0.9,0.95,0.975,0.99,0.995))
quantile(Losses)
fivenum(Losses)
logloss<-log(Losses)
logloss<-log(Losses)
hist(logloss,breaks=100, xlab="LogLoss",ylab="Density of Policy", main="Distribution of LogLoss",col=rgb(218,238,243,max=255),border=0,prob=TRUE)
curve(dnorm(x,mean=mean(logloss),sd=sd(logloss)),col="red",lwd=2,add=TRUE)
lines(density(logloss,adjust=3),col=rgb(112,48,160,max=255),lwd=2)
par(mfrow=c (2, 2))
plot(logloss ~Age.Band,col="#00000033")
plot(logloss ~Gender,col="#00000033")
plot(logloss ~Married,col="#00000033")
plot(logloss ~Fuel.Type,col="#00000033")
par(mfrow=c (1, 1))
plot(logloss ~Vehicle.Age.Band,col="#00000033")
bar<-ggplot(Insurance_train, aes(Gender,logloss,fill=Age.Band))
library("ggplot2")
bar<-ggplot(Insurance_train, aes(Gender,logloss,fill=Age.Band))
bar+ stat_summary(fun.y=mean,geom="histogram", position="dodge", width=0.2)
bar<-ggplot(Insurance_train, aes(Married, logloss,fill=Age.Band))
bar+ stat_summary(fun.y=mean,geom="histogram", position="dodge", width=0.2)
