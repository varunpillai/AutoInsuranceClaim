{
    "contents" : "\nReport outline\n#1. Data summary\n#2. distribution\n#3. plot\n#4. correlation\n# confidence interval and mean\n#5. build the model- linear regression - initial model - all relevant variables from assumption\n#6. check residuals (assumption)-  if not significant, exclude the variables  \n#7. determine final model  - predict, estimat,  effect, test\n#9. choose the best model\n\nMaximum likelyhood estimator\n#Importing csv file into R. save the insurance data as csv and update the file path below accordingly\ninsurance.data <- read.csv(file=\"/Users/ShireeXue/Documents/Stats/Insurance_Dataset.csv\", header=TRUE,sep=\",\")\ninsurance.data\n#attach the dataset so we don't need to refer to the dataset in every syntax\nattach(insurance.data)\n\n# Histogram of Losses(not CappedLoss!). too many outliners therefore we capped the loss to 1200\nhist(Losses,breaks=100, xlab=\"Loss (00s)\",ylab=\"# of Policy\", main=\"Distribution of Capped Loss\")\n\n# Descriptive- Histogram of Capped.Loss- distribution seems more normal\nhist(Capped.Losses, xlab=\"Capped.Loss (00s)\",ylab=\"# of Policy\", main=\"Distribution of Capped Loss\")\n\n# Descriptive- Plots for each pair, the color is to make the dots look lighter , easier to see\nplot(Capped.Losses ~Vehicle.Age,col=\"#00000033\")\nplot(Capped.Losses ~Age,col=\"#00000033\")\nplot(Capped.Losses ~Gender,col=\"#00000033\")\nplot(Capped.Losses ~Married,col=\"#00000033\")\nplot(Capped.Losses ~Fuel.Type,col=\"#00000033\")\nplot(Age, Years.of.Driving.Experience,col=\"#00000033\")\nboxplot(Capped.Losses ~Age.Band)\n\n\n# Descriptive- ggplot2 is a more advance plotting tool. We can use it to customize graphs and get more insights\nmore info: http://www.statmethods.net/advgraphs/ggplot2.html\n\ninstall.packages(\"ggplot2\")\nlibrary(ggplot2)\n\n#ggplot- Capped Losses by Age Group (note: the y axis scale seems wrong, I need to fix it)\nqplot(Capped.Losses, data=insurance.data, geom=\"density\", fill=Age.Band, alpha=I(.5), \n      main=\"Distribution of Capped Losses\", xlab=\"Capped.Losses\", \n      ylab=\"# of Policy\")\n\n\n#ggplot - Capped Losses by Gender\nqplot(Capped.Losses, data=insurance.data, geom=\"density\", fill=Gender, alpha=I(.5), \n      main=\"Distribution of Capped Losses\", xlab=\"Capped.Losses\", \n      ylab=\"# of Policy\")\n\n#ggplot-  Histogram- Gender + Age Group vs. Mean Capped Losses\n#source: http://stackoverflow.com/questions/17368223/ggplot2-multi-group-histogram-with-in-group-proportions-rather-than-frequency\n\nbar<-ggplot(insurance.data, aes(Gender, Capped.Losses,fill=Age.Band))\nbar+ stat_summary(fun.y=mean,geom=\"histogram\", position=\"dodge\", width=0.2)\n\n\nbar<-ggplot(insurance.data, aes(Married, Capped.Losses,fill=Age.Band))\nbar+ stat_summary(fun.y=mean,geom=\"histogram\", position=\"dodge\", width=0.2)\n\n\n\n\n\n# Descriptive- How to subset Capped Loss by Gender and take mean/variance of the capped loss. \nfemaleloss<- subset(insurance.data, Gender == \"F\")\nfemaleloss\nmean(femaleloss$Capped.Losses)\nvar(femaleloss$Capped.Losses)\n\nmaleloss<- subset(insurance.data, Gender == \"M\")\nmean(maleloss$Capped.Losses)\nvar(maleloss$Capped.Losses)\n\n# How to subset Capped Loss by Gender and take mean/variance of the capped loss. \nfemaleloss<- subset(insurance.data, Gender == \"F\")\nmean(femaleloss$Capped.Losses)\nvar(femaleloss$Capped.Losses)\n\nmaleloss<- subset(insurance.data, Gender == \"M\")\nmean(maleloss$Capped.Losses)\nvar(maleloss$Capped.Losses)\n\n\n#Find correlations between variables \n#(I did some research and found that we can only calculate correlations for continuous variables, not discrete ones )\ncor(Age,Capped.Losses)\ncor(Vehicle.Age,Capped.Losses)\n#interesting finding. include the plot in here. \n\n\n#Age and experience is highliy correlated. therefore we are dropping one of them as our variables.\ncor(Age,Years.of.Driving.Experience)\n\n\n# T test for paris of variables\nt.test(Capped.Losses ~Fuel.Type)\nt.test(Capped.Losses ~Gender)\nt.test(Capped.Losses ~Married)\n\n\n\n\n\n# Found this function to test whether variance is the same between groups. P value is less than 0.05\n# therefore, the variance is different. We can't use ANOVA. \nlibrary(car)\nleveneTest(Capped.Losses,Age.Band)\n\n# T test for the three age groups\n# first subset each age group, then run the t-tet\nyoung<- subset(insurance.data,Age.Band==\"16-25\")\nmiddle<- subset(insurance.data,Age.Band==\"26-59\")\nold<- subset(insurance.data,Age.Band==\"60+\")\nt.test(young$Capped.Losses, middle$Capped.Losses)\nt.test(middle$Capped.Losses, old$Capped.Losses)\nt.test(young$Capped.Losses,old$Capped.Losses)\n\n\n# Multiple linear regresssion (still need to figure out and add in Age band dummies)\ninitialmodel <- lm(Capped.Losses ~ Age + Gender.Dummy + Married.Dummy +Fuel.Type.Dummy,data=insurance.data)\nsummary(initialmodel)\nstep(initialmodel, direction =c (\"backward\"))\n\nmodel<- lm(Capped.Losses ~Age.Band)\nsummary(model)\n\nrelevel()\n \noneway.test(Capped.Losses ~Age.Band)\n\n\ninitialmodel2 <- lm(Capped.Losses ~ Gender.Dummy + Married.Dummy + Fuel.Type.Dummy,data=insurance.data)\nsummary(initialmodel2)\n\n\n\n\n\n  \n# How to subset Capped Loss by Gender and take mean/variance of the capped loss. \nfemaleloss<- subset(insurance.data, Gender == \"F\")\nmean(femaleloss$Capped.Losses)\nvar(femaleloss$Capped.Losses)\n\nmaleloss<- subset(insurance.data, Gender == \"M\")\nmean(maleloss$Capped.Losses)\nvar(maleloss$Capped.Losses)\n\n\n#just for later use\ncategory<- findInterval(Age, c(16, 25, 35,45,55,65))\ntapply(Capped.Losses, Age.Band, FUN=mean)  \nclass(Gender)\nas.factor()\n\nvar1<- c(\"Age\",\"Capped.Losses\")\ndata3<-insurance.data[var1]\nmodel<- lm(Capped.Losses ~Age)\nmodelsum<-summary(model)\npairs(data3)\n\nfitted(model)[1:5]\nnew<- data.frame(Age=c(16,30,50), Vehicle.Age=c(3,10,9))\npredict(model,newdata=new)\nmodelsum$r.squared\nconfint(model)\n",
    "created" : 1417295873414.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1854441190",
    "id" : "A0FFD502",
    "lastKnownWriteTime" : 1417295871,
    "path" : "C:/Users/Young Comp/Downloads/FinalProject2 (1).R",
    "project_path" : null,
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}